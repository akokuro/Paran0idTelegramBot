import telebot;
import random
from enum import Enum


class Status(Enum):
    open = 1
    close = 2
    notFoundNetwork = 3


bot = telebot.TeleBot('629898051:AAFKGaRfbMqa0jDH9Az4-B8pWEYKhfpcc9E');


@bot.message_handler(commands=['url'])
def url(message):
    markup = types.InlineKeyboardMarkup()
    btn_my_site = types.InlineKeyboardButton(text='Наш сайт', url='https://habrahabr.ru')
    markup.add(btn_my_site)
    bot.send_message(message.chat.id, "Нажми на кнопку и перейди на наш сайт.", reply_markup=markup)


@bot.message_handler(content_types=['new_chat_members'])
def greeting(message):
    bot.reply_to(message, text='Приветствем Вас в нашей системе Paran0id. Предлагаем вам зарегестрироваться в ыслужбе.')


@bot.message_handler(commands=['start'])
def start_message(message):
    bot.send_message(message.chat.id, 'Привет, ты написал мне /start')
    print(message.chat.id)


@bot.message_handler(commands=['help'])
def start_message(message):
    bot.send_message(message.chat.id, 'Статус замка *имя* - именно в таком формате вы должны написать мне запрос')
    print(message.chat.id)


@bot.message_handler(content_types=['text'])
def send_text(message):
    mes = message.text.lower()
    print(mes)
    if mes.find("статус") != -1:
        number = mes.split()[len(mes.split()) - 1]
        request(message, number)
    elif message.text.lower() == 'пока':
        bot.send_message(message.chat.id, 'Прощай, создатель')


def request(message, number):
    bot.send_message(message.chat.id, 'Отправляю запрос на замок N ' + number)
    r = random.randint(1, 3)
    print(r)
    stat = Status(r)
    bot.send_message(message.chat.id, 'статус замка ' + stat.name)


bot.polling()
